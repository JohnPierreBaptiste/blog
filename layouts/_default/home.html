{{- define "main" }}

{{- if (and site.Params.profileMode.enabled .IsHome) }}
{{- partial "index_profile.html" . }}
{{- else }} {{/* if not profileMode */}}

{{- if not .IsHome }}
<header class="page-header">
  {{ partial "breadcrumbs.html" . }}
  <h1>{{ .Title }}</h1>
  {{- if .Description }}
  <div class="post-description">
    {{ .Description }}
  </div>
  {{- end }}
</header>
{{- end }}

{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}

<!-- Recent Activity Section -->
<div class="recent-activity">
  <h2>Recent Activity</h2>
  {{- range first 1 $pages }}
  <article class="post-entry">
    <header class="entry-header">
      <h3>{{ .Title }}</h3>
    </header>
    <div class="entry-content">
      <p>{{ .Description }}</p>
    </div>
    <footer class="entry-footer">
      <time>{{ .Date.Format "January 2, 2006" }}</time>
    </footer>
    <a class="entry-link" href="{{ .Permalink }}"></a>
  </article>
  {{- end }}
</div>

<!-- All Posts Section -->
<div class="posts-section">
  <h2>All Posts</h2>
  <div class="posts-description">
    A collection of personal reflections and stories, numbered sequentially 
  </div>
  
  {{- range $pages }}
  <article class="post-entry">
    <header class="entry-header">
      <h2>{{ .Title }}</h2>
    </header>
    <div class="entry-content">
      <p class="post-description">{{ .Description }}</p>
    </div>
    <footer class="entry-footer">
      <time>{{ .Date.Format "January 2, 2006" }}</time>
    </footer>
    <a class="entry-link" aria-label="post link to {{ .Title | plainify }}" href="{{ .Permalink }}"></a>
  </article>
  {{- end }}
</div>

{{- end }}{{/* end profileMode */}}

{{- end }}{{- /* end main */ -}}
